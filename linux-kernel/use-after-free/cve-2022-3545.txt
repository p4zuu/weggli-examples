weggli -R init=_init '
_ $func(_ id) {
        struct _* $cache; 
        $cache->id = $id; 
        $err = $init(_); 
        if ($err < 0){
                return _;
        }
}' ./drivers

# NOTE: I think it's not possible to restrict weggli to only match the error returned by a specific function
# There is a second result that matches 'if ($err < 0){', but fortunatley it's another use-after-free scenario